<div class="list-page__header">
  <div class="list-page__header-actions">
    <h2 class="list-page__title">
      {{ "AGENT_CHAT_LIST.TITLES.MAIN" | transloco }}
    </h2>
    <button class="btn btn-primary" [routerLink]="['./', 'add']">
      {{ "CHAT_LIST.NEW_CHAT_BUTTON" | transloco }}
    </button>
  </div>
  <p class="list-page__description">
    {{ "AGENT_CHAT_LIST.DESCRIPTIONS.MAIN" | transloco }}
  </p>
</div>

<div class="list-page__content">
  <hub-ui-table
    [headers]="headers"
    [loading]="paginatedData.isLoading()"
    [data]="paginatedData.value()"
    [searchable]="false"
    [clickFn]="goToChat.bind(this)"
    [searchable]="true"
    [options]="{ hoverableRows: true, scrollable: true }"
    [clickFn]="navigateTo.bind(this)"
    [(searchTerm)]="searchTerm"
    [(filters)]="dynamicFilters"
    [(ordination)]="ordination"
    [(perPage)]="perPage"
    [(page)]="page"
  >
    <ng-template cellTpt header="updated_at" let-property="property">
      {{ formatDate(property) }}
    </ng-template>
    <ng-template cellTpt header="pin" let-row="row">
      <button
        type="button"
        class="btn btn-link p-0 pin-btn"
        [class.pinned]="isPinned(row)"
        [attr.aria-label]="
          isPinned(row)
            ? ('CHATLIST.BUTTONS.UNPIN_CHAT' | transloco)
            : ('CHATLIST.BUTTONS.PIN_CHAT' | transloco)
        "
        (click)="togglePin(row); $event.stopPropagation()"
        [disabled]="loadingPins().has(row.id)"
      >
        <ng-container *ngIf="!loadingPins().has(row.id); else loading">
          <i
            class="bi"
            [class.bi-pin-fill]="isPinned(row)"
            [class.bi-pin]="!isPinned(row)"
          ></i>
        </ng-container>
        <ng-template #loading>
          <span class="spinner-border spinner-border-sm"></span>
        </ng-template>
      </button>
    </ng-template>
    <ng-template noDataTpt>
      {{ "CHAT_LIST.NO_CHATS" | transloco }}
    </ng-template>
  </hub-ui-table>
</div>
