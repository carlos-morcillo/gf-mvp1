<form
  [formGroup]="form"
  (ngSubmit)="onSubmit()"
  class="container py-4 vstack gap-3"
  (drop)="onDrop($event)"
  (dragover)="$event.preventDefault()"
>
  <div class="d-flex mb-3">
    <button type="button" class="btn btn-link me-2" routerLink="../">
      <i class="fas fa-arrow-left"></i>
    </button>
    <h1 class="h3 mb-0">{{ 'AGENT_EDITION.TITLES.MAIN' | transloco }}</h1>
  </div>

  <div class="mb-3">
    <label class="form-label">{{ 'AGENT_FORM.LABELS.NAME' | transloco }}</label>
    <input class="form-control" type="text" formControlName="name" />
  </div>

  <div class="mb-3" formGroupName="meta">
    <label class="form-label">{{ 'AGENT_FORM.LABELS.DESCRIPTION' | transloco }}</label>
    <textarea rows="3" class="form-control" formControlName="description"></textarea>
  </div>

  <div class="mb-3" formGroupName="params">
    <label class="form-label">{{ 'AGENT_FORM.LABELS.SYSTEM' | transloco }}</label>
    <textarea rows="3" class="form-control" formControlName="system"></textarea>
  </div>

  <div class="mb-3">
    <label class="form-label">{{ 'AGENT_FORM.LABELS.BASE_MODEL' | transloco }}</label>
    <ng-select
      [items]="modelsResource.value()"
      [loading]="modelsResource.isLoading()"
      bindLabel="name"
      bindValue="id"
      formControlName="base_model_id"
    ></ng-select>
  </div>

  <div class="mb-3" formGroupName="meta">
    <label class="form-label">
      {{ 'AGENT_FORM.LABELS.CAPABILITIES' | transloco }}
      <i
        class="fas fa-question-circle ms-1"
        [title]="'AGENT_FORM.TIPS.CAPABILITIES' | transloco"
      ></i>
    </label>
    <div formGroupName="capabilities" class="d-flex flex-wrap gap-3">
      <div class="form-check" *ngFor="let cap of capabilities">
        <input
          type="checkbox"
          class="form-check-input"
          [id]="cap"
          [formControlName]="cap"
        />
        <label class="form-check-label" [for]="cap">{{ cap | titlecase }}</label>
      </div>
    </div>
  </div>

  <div class="mb-3" formGroupName="meta">
    <label class="form-label">{{ 'AGENT_FORM.LABELS.KNOWLEDGE' | transloco }}</label>
    <ng-select
      [items]="knowledgeResource.value()"
      [loading]="knowledgeResource.isLoading()"
      bindLabel="name"
      [multiple]="true"
      formControlName="knowledge"
    ></ng-select>
  </div>

  <div class="mb-3" formGroupName="meta">
    <label class="form-label">{{ 'AGENT_FORM.LABELS.PROFILE_IMAGE' | transloco }}</label>
    <div class="border rounded p-3 text-center">
      <img *ngIf="imagePreview" [src]="imagePreview" class="img-thumbnail mb-2" alt="preview" />
      <input type="file" accept="image/*" class="form-control" (change)="onImageSelect($event)" />
      <small class="text-muted">{{ 'AGENT_EDITION.FORM.DRAG_DROP' | transloco }}</small>
    </div>
  </div>

  <div class="form-check mb-3">
    <input type="checkbox" class="form-check-input" formControlName="is_active" id="active" />
    <label for="active" class="form-check-label">{{ 'AGENT_FORM.LABELS.ACTIVE' | transloco }}</label>
  </div>

  <button type="submit" class="btn btn-primary w-100">
    {{ 'AGENT_EDITION.BUTTONS.SAVE' | transloco }}
  </button>
</form>

